---
interface Props {
  alt?: string;
  size?: "sm" | "md" | "lg";
  shape?: "round" | "soft" | "hex";
  className?: string;
  loading?: "lazy" | "eager";
}

const {
  alt = "Portrait of Mr Panda",
  size = "md",
  shape = "soft",
  className = "",
  loading = "lazy"
} = Astro.props;

const sizeClass = {
  sm: "h-8 w-8",
  md: "h-14 w-14",
  lg: "h-56 w-56"
}[size];

const shapeClass = {
  round: "rounded-full",
  soft: "rounded-2xl",
  hex: ""
}[shape];

const isHex = shape === "hex";
const roundedHexPath =
  "M96 43.072 L79 13.627 Q75 6.699 67 6.699 L33 6.699 Q25 6.699 21 13.627 L4 43.072 Q0 50 4 56.928 L21 86.373 Q25 93.301 33 93.301 L67 93.301 Q75 93.301 79 86.373 L96 56.928 Q100 50 96 43.072 Z";
---

{
  isHex ? (
    <div class={`relative ${sizeClass} ${className}`}>
      <svg
        viewBox="0 0 100 100"
        class="h-full w-full drop-shadow-[0_12px_24px_rgba(15,23,42,0.2)]"
        role="img"
        aria-label={alt}
      >
        <defs>
          <clipPath id="brand-avatar-hex-clip">
            <path d={roundedHexPath}></path>
          </clipPath>
        </defs>

        <path d={roundedHexPath} fill="rgba(248, 251, 255, 0.95)"></path>
        <image
          href="/mrpanda.jpg"
          x="0"
          y="5"
          width="100"
          height="100"
          preserveAspectRatio="xMidYMid slice"
          clip-path="url(#brand-avatar-hex-clip)"
        ></image>
        <path d={roundedHexPath} fill="none" stroke="rgba(11, 132, 201, 0.48)" stroke-width="2"></path>
      </svg>
    </div>
  ) : (
    <div
      class={`relative overflow-hidden border border-line/80 bg-paper shadow-[0_12px_24px_-20px_rgba(15,23,42,0.9)] ${sizeClass} ${shapeClass} ${className}`}
    >
      <img
        src="/mrpanda.jpg"
        alt={alt}
        loading={loading}
        decoding="async"
        class="h-full w-full object-cover"
      />
      <span
        aria-hidden="true"
        class="pointer-events-none absolute inset-0 bg-gradient-to-b from-paper/0 via-paper/0 to-ink/8"
      ></span>
    </div>
  )
}
